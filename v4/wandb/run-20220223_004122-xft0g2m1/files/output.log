
[ INFO ]: Loading DepthODFDatasetLoader dataset. Positional Encoding: False, Coordinate Type: direction, Autodecoder: False
DATA SIZE: 1000
[ INFO ]: Loading DepthODFDatasetLoader dataset. Positional Encoding: False, Coordinate Type: direction, Autodecoder: False
[ INFO ]: Training data has 1000 shapes and 1000 rays per sample.
[ INFO ]: Validation data has 200 shapes and 10 rays per sample.
Loading checkpoint v3_test_constant_checkpoint_000013.tar
----------------------------- EPOCH: 15/21 -----------------------------
Training...





 22%|████████████▋                                            | 14/63 [00:11<00:41,  1.17it/s]
Traceback (most recent call last):
  File "train.py", line 217, in <module>
    train(Args.output_dir, Args.expt_name, NeuralODF, optimizer, TrainDataLoader, ValDataLoader, loss_history, hyperparameters, Device)
  File "train.py", line 55, in train
    for batch in tqdm(train_loader):
  File "C:\Users\Trevor\miniconda3\envs\ivlresearch\lib\site-packages\tqdm\std.py", line 1176, in __iter__
    for obj in iterable:
  File "C:\Users\Trevor\miniconda3\envs\ivlresearch\lib\site-packages\torch\utils\data\dataloader.py", line 435, in __next__
    data = self._next_data()
  File "C:\Users\Trevor\miniconda3\envs\ivlresearch\lib\site-packages\torch\utils\data\dataloader.py", line 475, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "C:\Users\Trevor\miniconda3\envs\ivlresearch\lib\site-packages\torch\utils\data\_utils\fetch.py", line 44, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "C:\Users\Trevor\miniconda3\envs\ivlresearch\lib\site-packages\torch\utils\data\_utils\fetch.py", line 44, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "loaders\depth_odf_dataset_5d.py", line 107, in __getitem__
    self.Sampler = DepthMapSampler(DepthData, TargetRays=self.nTargetSamples, UsePosEnc=self.PositionalEnc)
  File "loaders\depth_sampler_5d.py", line 41, in __init__
    self.sample(self.nTargetRays)
  File "loaders\depth_sampler_5d.py", line 46, in sample
    AllStartPoints = np.tile(StartPoint, (AllEndPoints.shape[0], 1))
  File "<__array_function__ internals>", line 5, in tile
  File "C:\Users\Trevor\miniconda3\envs\ivlresearch\lib\site-packages\numpy\lib\shape_base.py", line 1258, in tile
    c = c.reshape(-1, n).repeat(nrep, 0)
numpy.core._exceptions._ArrayMemoryError: Unable to allocate 1.50 MiB for an array with shape (65536, 3) and data type float64